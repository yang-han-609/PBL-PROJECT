<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnSync ç™»å½•è°ƒè¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>LearnSync ç™»å½•è°ƒè¯•å·¥å…·</h1>

    <div class="debug-section">
        <h2>1. åº“æ–‡ä»¶æ£€æŸ¥</h2>
        <div id="library-status">æ£€æŸ¥ä¸­...</div>
    </div>

    <div class="debug-section">
        <h2>2. MD5 åŠŸèƒ½æµ‹è¯•</h2>
        <div id="md5-status">æµ‹è¯•ä¸­...</div>
    </div>

    <div class="debug-section">
        <h2>3. æ•°æ®å­˜å‚¨æµ‹è¯•</h2>
        <div id="storage-status">æµ‹è¯•ä¸­...</div>
    </div>

    <div class="debug-section">
        <h2>4. è®¤è¯æ¨¡å—æµ‹è¯•</h2>
        <div id="auth-status">æµ‹è¯•ä¸­...</div>
    </div>

    <div class="debug-section">
        <h2>5. ä¼šè¯çŠ¶æ€è¯¦ç»†æ£€æŸ¥</h2>
        <button onclick="checkSessionDetails()">æ£€æŸ¥ä¼šè¯è¯¦æƒ…</button>
        <div id="session-status"></div>
    </div>

    <div class="debug-section">
        <h2>6. ä»»åŠ¡åˆ›å»ºæµ‹è¯•</h2>
        <button onclick="testTaskCreation()">æµ‹è¯•ä»»åŠ¡åˆ›å»º</button>
        <div id="task-test-status"></div>
    </div>

    <div class="debug-section">
        <h2>7. æ¸…é™¤å’Œä¿®å¤æ•°æ®</h2>
        <button onclick="clearAuthData()">æ¸…é™¤è®¤è¯æ•°æ®</button>
        <button onclick="forceFixSession()">å¼ºåˆ¶ä¿®å¤ä¼šè¯æ•°æ®</button>
        <button onclick="clearAllData()">æ¸…é™¤æ‰€æœ‰LocalStorageæ•°æ®</button>
        <button onclick="initDefaultData()">é‡æ–°åˆå§‹åŒ–é»˜è®¤æ•°æ®</button>
        <button onclick="fixUsers()">ä¿®å¤ç”¨æˆ·isActiveå­—æ®µ</button>
        <button onclick="location.reload()">é‡æ–°åŠ è½½é¡µé¢</button>
        <div id="clear-status"></div>
    </div>

    <!-- å¼•å…¥åº“æ–‡ä»¶ -->
    <script src="lib/md5.min.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>

    <script>
        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œæ‰€æœ‰æµ‹è¯•
        document.addEventListener('DOMContentLoaded', function() {
            checkLibraries();
            testMD5();
            testStorage();
            testAuth();
        });

        function checkLibraries() {
            const statusDiv = document.getElementById('library-status');
            let html = '';

            // æ£€æŸ¥MD5åº“
            if (typeof md5 !== 'undefined') {
                html += '<p class="success">âœ… MD5åº“å·²åŠ è½½</p>';
            } else {
                html += '<p class="error">âŒ MD5åº“æœªåŠ è½½</p>';
            }

            // æ£€æŸ¥Storage
            if (typeof Storage !== 'undefined') {
                html += '<p class="success">âœ… Storageæ¨¡å—å·²åŠ è½½</p>';
            } else {
                html += '<p class="error">âŒ Storageæ¨¡å—æœªåŠ è½½</p>';
            }

            // æ£€æŸ¥Auth
            if (typeof Auth !== 'undefined') {
                html += '<p class="success">âœ… Authæ¨¡å—å·²åŠ è½½</p>';
            } else {
                html += '<p class="error">âŒ Authæ¨¡å—æœªåŠ è½½</p>';
            }

            statusDiv.innerHTML = html;
        }

        function testMD5() {
            const statusDiv = document.getElementById('md5-status');
            let html = '';

            try {
                const adminHash = md5('admin');
                const demoHash = md5('demo');

                html += `<p>MD5('admin') = ${adminHash}</p>`;
                html += `<p>MD5('demo') = ${demoHash}</p>`;

                // æ£€æŸ¥æ˜¯å¦ä¸æœŸæœ›å€¼åŒ¹é…
                const expectedAdminHash = '21232f297a57a5a743894a0e4a801fc3';
                const expectedDemoHash = 'fe01ce2a7fbac8fafaed7c982a04e229';

                if (adminHash === expectedAdminHash) {
                    html += '<p class="success">âœ… admin MD5å“ˆå¸Œæ­£ç¡®</p>';
                } else {
                    html += `<p class="error">âŒ admin MD5å“ˆå¸Œä¸åŒ¹é… (æœŸæœ›: ${expectedAdminHash})</p>`;
                }

                if (demoHash === expectedDemoHash) {
                    html += '<p class="success">âœ… demo MD5å“ˆå¸Œæ­£ç¡®</p>';
                } else {
                    html += `<p class="error">âŒ demo MD5å“ˆå¸Œä¸åŒ¹é… (æœŸæœ›: ${expectedDemoHash})</p>`;
                }

                html += '<p class="info">ğŸ’¡ å¦‚æœMD5ä¸åŒ¹é…ï¼Œè¯·æ›´æ–°storage.jsä¸­çš„å¯†ç å“ˆå¸Œå€¼</p>';

            } catch (error) {
                html += `<p class="error">âŒ MD5æµ‹è¯•å¤±è´¥: ${error.message}</p>`;
            }

            statusDiv.innerHTML = html;
        }

        function testStorage() {
            const statusDiv = document.getElementById('storage-status');
            let html = '';

            try {
                // æ£€æŸ¥LocalStorageæ˜¯å¦å¯ç”¨
                if (typeof Storage !== 'undefined') {
                    html += '<p class="success">âœ… LocalStorageå¯ç”¨</p>';

                    // æ£€æŸ¥ç”¨æˆ·æ•°æ®
                    const users = Storage.get('users');
                    html += `<p>ç”¨æˆ·æ•°é‡: ${users.length}</p>`;

                    if (users.length > 0) {
                        html += '<p class="info">ç°æœ‰ç”¨æˆ·:</p>';
                        users.forEach(user => {
                            html += `<p>- ${user.username} (${user.role})</p>`;
                        });
                    } else {
                        html += '<p class="info">æš‚æ— ç”¨æˆ·æ•°æ®</p>';
                    }

                    // æ£€æŸ¥å…¶ä»–æ•°æ®
                    const tasks = Storage.get('tasks');
                    const resources = Storage.get('resources');
                    const progress = Storage.get('progress');

                    html += `<p>ä»»åŠ¡æ•°é‡: ${tasks.length}</p>`;
                    html += `<p>èµ„æºæ•°é‡: ${resources.length}</p>`;
                    html += `<p>è¿›åº¦è®°å½•: ${progress.length}</p>`;

                } else {
                    html += '<p class="error">âŒ Storageæ¨¡å—ä¸å¯ç”¨</p>';
                }

            } catch (error) {
                html += `<p class="error">âŒ å­˜å‚¨æµ‹è¯•å¤±è´¥: ${error.message}</p>`;
            }

            statusDiv.innerHTML = html;
        }

        function testAuth() {
            const statusDiv = document.getElementById('auth-status');
            let html = '';

            try {
                if (typeof Auth !== 'undefined') {
                    html += '<p class="success">âœ… Authæ¨¡å—å¯ç”¨</p>';

                    // æ£€æŸ¥ç™»å½•çŠ¶æ€
                    const isLoggedIn = Auth.isLoggedIn();
                    html += `<p>å½“å‰ç™»å½•çŠ¶æ€: ${isLoggedIn ? 'å·²ç™»å½•' : 'æœªç™»å½•'}</p>`;

                    if (isLoggedIn) {
                        const currentUser = Auth.getCurrentUser();
                        html += `<p>å½“å‰ç”¨æˆ·: ${currentUser.username} (${currentUser.role})</p>`;
                    }

                    // æµ‹è¯•ç”¨æˆ·éªŒè¯
                    const testUsers = Storage.get('users');
                    html += '<p class="info">æµ‹è¯•ç”¨æˆ·éªŒè¯:</p>';

                    testUsers.forEach(user => {
                        const testResult = Auth.login(user.username, user.username); // ç”¨æˆ·åä½œä¸ºå¯†ç æµ‹è¯•
                        if (testResult.success) {
                            html += `<p class="success">âœ… ${user.username} éªŒè¯æˆåŠŸ</p>`;
                        } else {
                            html += `<p class="error">âŒ ${user.username} éªŒè¯å¤±è´¥: ${testResult.message}</p>`;
                        }
                    });

                } else {
                    html += '<p class="error">âŒ Authæ¨¡å—ä¸å¯ç”¨</p>';
                }

            } catch (error) {
                html += `<p class="error">âŒ è®¤è¯æµ‹è¯•å¤±è´¥: ${error.message}</p>`;
            }

            statusDiv.innerHTML = html;
        }

        function clearAllData() {
            const statusDiv = document.getElementById('clear-status');

            try {
                localStorage.clear();
                statusDiv.innerHTML = '<p class="success">âœ… æ‰€æœ‰LocalStorageæ•°æ®å·²æ¸…é™¤</p>';
                statusDiv.innerHTML += '<button onclick="location.reload()">é‡æ–°åŠ è½½é¡µé¢</button>';
            } catch (error) {
                statusDiv.innerHTML = `<p class="error">âŒ æ¸…é™¤æ•°æ®å¤±è´¥: ${error.message}</p>`;
            }
        }

        function initDefaultData() {
            const statusDiv = document.getElementById('clear-status');

            try {
                // å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–
                Storage.initializeDefaultData();
                statusDiv.innerHTML = '<p class="success">âœ… é»˜è®¤æ•°æ®å·²é‡æ–°åˆå§‹åŒ–</p>';
                statusDiv.innerHTML += '<button onclick="location.reload()">é‡æ–°åŠ è½½é¡µé¢</button>';
            } catch (error) {
                statusDiv.innerHTML = `<p class="error">âŒ åˆå§‹åŒ–æ•°æ®å¤±è´¥: ${error.message}</p>`;
            }
        }

        function fixUsers() {
            const statusDiv = document.getElementById('clear-status');

            try {
                // ç›´æ¥ä¿®å¤ç”¨æˆ·æ•°æ®
                const users = Storage.get('users');
                const updatedUsers = users.map(user => ({
                    ...user,
                    isActive: true
                }));

                Storage.set('users', updatedUsers);
                statusDiv.innerHTML = '<p class="success">âœ… ç”¨æˆ·isActiveå­—æ®µå·²ä¿®å¤</p>';
                statusDiv.innerHTML += '<p class="info">æ›´æ–°äº† ' + users.length + ' ä¸ªç”¨æˆ·</p>';
                statusDiv.innerHTML += '<button onclick="location.reload()">é‡æ–°åŠ è½½é¡µé¢æµ‹è¯•ç™»å½•</button>';
            } catch (error) {
                statusDiv.innerHTML = `<p class="error">âŒ ä¿®å¤ç”¨æˆ·å¤±è´¥: ${error.message}</p>`;
            }
        }

        function checkSessionDetails() {
            const statusDiv = document.getElementById('session-status');
            let html = '';

            try {
                // æ£€æŸ¥sessionStorage
                const sessionData = sessionStorage.getItem('learnsync_current_user');
                html += '<p><strong>SessionStorageæ•°æ®:</strong></p>';
                if (sessionData) {
                    const parsedSession = JSON.parse(sessionData);
                    html += `<pre>${JSON.stringify(parsedSession, null, 2)}</pre>`;
                    html += `<p class="info">SessionStorageä¸­çš„ç”¨æˆ·ID: ${parsedSession.id || 'æœªæ‰¾åˆ°'}</p>`;
                    html += `<p class="info">SessionStorageä¸­çš„ç”¨æˆ·å: ${parsedSession.username || 'æœªæ‰¾åˆ°'}</p>`;
                } else {
                    html += '<p class="error">âŒ SessionStorageä¸­æ²¡æœ‰ç”¨æˆ·æ•°æ®</p>';
                }

                // æ£€æŸ¥localStorageè®°ä½æˆ‘æ•°æ®
                const rememberData = localStorage.getItem('learnsync_current_user_remember');
                html += '<p><strong>localStorageè®°ä½æˆ‘æ•°æ®:</strong></p>';
                if (rememberData) {
                    const parsedRemember = JSON.parse(rememberData);
                    html += `<pre>${JSON.stringify(parsedRemember, null, 2)}</pre>`;
                    html += `<p class="info">è®°ä½æˆ‘æ•°æ®ä¸­çš„ç”¨æˆ·ID: ${parsedRemember.id || 'æœªæ‰¾åˆ°'}</p>`;
                } else {
                    html += '<p class="info">â„¹ï¸ localStorageä¸­æ²¡æœ‰è®°ä½æˆ‘æ•°æ®</p>';
                }

                // è°ƒç”¨Auth.getCurrentUser()å¹¶è®°å½•è¯¦ç»†è¿‡ç¨‹
                html += '<p><strong>Auth.getCurrentUser()è°ƒç”¨è¿‡ç¨‹:</strong></p>';
                try {
                    const currentUser = Auth.getCurrentUser();
                    if (currentUser) {
                        html += `<p class="success">âœ… æˆåŠŸè·å–å½“å‰ç”¨æˆ·</p>`;
                        html += `<pre>${JSON.stringify(currentUser, null, 2)}</pre>`;
                    } else {
                        html += `<p class="error">âŒ æ— æ³•è·å–å½“å‰ç”¨æˆ·</p>`;
                    }
                } catch (authError) {
                    html += `<p class="error">âŒ Auth.getCurrentUser()å‡ºé”™: ${authError.message}</p>`;
                    html += `<p class="error">é”™è¯¯å †æ ˆ: ${authError.stack}</p>`;
                }

                // æ£€æŸ¥Auth.isLoggedIn()
                html += '<p><strong>Auth.isLoggedIn()ç»“æœ:</strong></p>';
                try {
                    const isLoggedIn = Auth.isLoggedIn();
                    html += `<p class="${isLoggedIn ? 'success' : 'error'}">${isLoggedIn ? 'âœ… å·²ç™»å½•' : 'âŒ æœªç™»å½•'}</p>`;
                } catch (loginError) {
                    html += `<p class="error">âŒ Auth.isLoggedIn()å‡ºé”™: ${loginError.message}</p>`;
                }

                statusDiv.innerHTML = html;
            } catch (error) {
                statusDiv.innerHTML = `<p class="error">âŒ æ£€æŸ¥ä¼šè¯è¯¦æƒ…å¤±è´¥: ${error.message}</p>`;
            }
        }

        function testTaskCreation() {
            const statusDiv = document.getElementById('task-test-status');
            let html = '';

            try {
                // é¦–å…ˆæ£€æŸ¥ç”¨æˆ·çŠ¶æ€
                html += '<p><strong>æ­¥éª¤1: æ£€æŸ¥ç”¨æˆ·çŠ¶æ€</strong></p>';
                const currentUser = Auth.getCurrentUser();

                if (!currentUser) {
                    html += '<p class="error">âŒ ç”¨æˆ·æœªç™»å½•ï¼Œæ— æ³•æµ‹è¯•ä»»åŠ¡åˆ›å»º</p>';
                    statusDiv.innerHTML = html;
                    return;
                }

                html += `<p class="success">âœ… å½“å‰ç”¨æˆ·: ${currentUser.username} (ID: ${currentUser.id})</p>`;

                // åˆ›å»ºæµ‹è¯•ä»»åŠ¡æ•°æ®
                html += '<p><strong>æ­¥éª¤2: åˆ›å»ºæµ‹è¯•ä»»åŠ¡</strong></p>';
                const testTaskData = {
                    title: 'æµ‹è¯•ä»»åŠ¡ ' + new Date().toLocaleTimeString(),
                    description: 'è¿™æ˜¯ä¸€ä¸ªè°ƒè¯•æµ‹è¯•ä»»åŠ¡',
                    priority: 'Medium',
                    status: 'Todo'
                };

                html += `<p>æµ‹è¯•ä»»åŠ¡æ•°æ®: ${JSON.stringify(testTaskData)}</p>`;

                // æ¨¡æ‹Ÿè°ƒç”¨SafeTaskManager.createTask
                html += '<p><strong>æ­¥éª¤3: è°ƒç”¨SafeTaskManager.createTask</strong></p>';

                // æ£€æŸ¥SafeTaskManageræ˜¯å¦å­˜åœ¨
                if (typeof window.SafeTaskManager === 'undefined') {
                    // æ‰‹åŠ¨åˆ›å»ºSafeTaskManager
                    html += '<p class="info">â„¹ï¸ SafeTaskManageræœªå®šä¹‰ï¼Œæ‰‹åŠ¨åˆ›å»ºæµ‹è¯•ç‰ˆæœ¬</p>';

                    window.SafeTaskManager = {
                        createTask: function(taskData, userId) {
                            if (!taskData.title) {
                                return { success: false, message: 'è¯·è¾“å…¥ä»»åŠ¡æ ‡é¢˜' };
                            }

                            if (!userId) {
                                return { success: false, message: 'ç”¨æˆ·æœªç™»å½•' };
                            }

                            const newTask = {
                                id: Date.now().toString() + Math.random().toString(36).substr(2),
                                title: taskData.title.trim(),
                                description: taskData.description ? taskData.description.trim() : '',
                                priority: taskData.priority || 'Medium',
                                userId: userId,
                                status: taskData.status || 'Todo',
                                createdAt: new Date().toISOString()
                            };

                            try {
                                const existingTasks = JSON.parse(localStorage.getItem('ls_tasks') || '[]');
                                existingTasks.push(newTask);
                                localStorage.setItem('ls_tasks', JSON.stringify(existingTasks));
                                return { success: true, message: 'ä»»åŠ¡åˆ›å»ºæˆåŠŸï¼', task: newTask };
                            } catch (error) {
                                return { success: false, message: 'ä»»åŠ¡åˆ›å»ºå¤±è´¥ï¼Œç³»ç»Ÿé”™è¯¯' };
                            }
                        }
                    };
                }

                // è°ƒç”¨åˆ›å»ºä»»åŠ¡
                const result = window.SafeTaskManager.createTask(testTaskData, currentUser.id);

                if (result.success) {
                    html += '<p class="success">âœ… ä»»åŠ¡åˆ›å»ºæˆåŠŸï¼</p>';
                    html += `<p>ä»»åŠ¡ID: ${result.task.id}</p>`;
                    html += `<p>ä»»åŠ¡æ ‡é¢˜: ${result.task.title}</p>`;
                    html += `<pre>${JSON.stringify(result.task, null, 2)}</pre>`;
                } else {
                    html += `<p class="error">âŒ ä»»åŠ¡åˆ›å»ºå¤±è´¥: ${result.message}</p>`;
                }

                // éªŒè¯ä»»åŠ¡æ˜¯å¦çœŸçš„è¢«ä¿å­˜
                html += '<p><strong>æ­¥éª¤4: éªŒè¯ä»»åŠ¡ä¿å­˜</strong></p>';
                const savedTasks = JSON.parse(localStorage.getItem('ls_tasks') || '[]');
                const userTasks = savedTasks.filter(task => task.userId === currentUser.id);
                html += `<p>æ€»ä»»åŠ¡æ•°: ${savedTasks.length}</p>`;
                html += `<p>å½“å‰ç”¨æˆ·ä»»åŠ¡æ•°: ${userTasks.length}</p>`;

                if (userTasks.length > 0) {
                    html += '<p class="success">âœ… ä»»åŠ¡å·²æˆåŠŸä¿å­˜åˆ°localStorage</p>';
                    const latestTask = userTasks[userTasks.length - 1];
                    html += `<p>æœ€æ–°ä»»åŠ¡: ${latestTask.title} (åˆ›å»ºäº: ${new Date(latestTask.createdAt).toLocaleString()})</p>`;
                }

                statusDiv.innerHTML = html;
            } catch (error) {
                html += `<p class="error">âŒ æµ‹è¯•ä»»åŠ¡åˆ›å»ºå¤±è´¥: ${error.message}</p>`;
                html += `<p class="error">é”™è¯¯å †æ ˆ: ${error.stack}</p>`;
                statusDiv.innerHTML = html;
            }
        }

        function clearAuthData() {
            const statusDiv = document.getElementById('clear-status');

            try {
                sessionStorage.removeItem('learnsync_current_user');
                localStorage.removeItem('learnsync_current_user_remember');

                statusDiv.innerHTML = '<div class="alert alert-success">âœ… è®¤è¯æ•°æ®å·²æ¸…é™¤</div>';
                statusDiv.innerHTML += '<p class="info">è¯·é‡æ–°ç™»å½•ä»¥åˆ›å»ºæ–°çš„ä¼šè¯</p>';
            } catch (error) {
                statusDiv.innerHTML = '<div class="alert alert-danger">âŒ æ¸…é™¤è®¤è¯æ•°æ®å¤±è´¥: ' + error.message + '</div>';
            }
        }

        function forceFixSession() {
            const statusDiv = document.getElementById('clear-status');

            try {
                let html = '<p><strong>å¼ºåˆ¶ä¿®å¤ä¼šè¯æ•°æ®...</strong></p>';

                // è·å–ç”¨æˆ·åˆ—è¡¨
                const users = Storage.get('users');
                html += `<p>æ‰¾åˆ° ${users.length} ä¸ªç”¨æˆ·</p>`;

                if (users.length === 0) {
                    html += '<p class="error">âŒ æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç”¨æˆ·</p>';
                    statusDiv.innerHTML = html;
                    return;
                }

                // æ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨ä¾›é€‰æ‹©
                html += '<p><strong>å¯ç”¨çš„ç”¨æˆ·:</strong></p>';
                users.forEach((user, index) => {
                    const hasId = user.id ? 'âœ…' : 'âŒ';
                    const isActive = user.isActive ? 'âœ…' : 'âŒ';
                    html += `<p>${index + 1}. ${user.username} (${user.role}) ID:${hasId} Active:${isActive}</p>`;
                });

                html += '<p><strong>è‡ªåŠ¨ä¿®å¤ç¬¬ä¸€ä¸ªæœ‰æ•ˆç”¨æˆ·...</strong></p>';

                // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœ‰IDä¸”æ´»è·ƒçš„ç”¨æˆ·
                let validUser = null;
                for (let user of users) {
                    if (user.id && user.isActive) {
                        validUser = user;
                        break;
                    }
                }

                if (!validUser) {
                    html += '<p class="error">âŒ æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„ç”¨æˆ·ï¼Œå°è¯•ä¿®å¤æ‰€æœ‰ç”¨æˆ·...</p>';
                    // ä¸ºæ‰€æœ‰ç”¨æˆ·æ·»åŠ ID
                    const fixedUsers = users.map((user, index) => ({
                        ...user,
                        id: user.id || 'user_' + Date.now() + '_' + index,
                        isActive: true
                    }));
                    Storage.set('users', fixedUsers);
                    validUser = fixedUsers[0];
                    html += '<p class="success">âœ… å·²ä¸ºæ‰€æœ‰ç”¨æˆ·æ·»åŠ IDå¹¶è®¾ç½®ä¸ºæ´»è·ƒçŠ¶æ€</p>';
                }

                if (validUser) {
                    html += `<p class="success">âœ… é€‰æ‹©ç”¨æˆ·: ${validUser.username} (ID: ${validUser.id})</p>`;

                    // åˆ›å»ºä¼šè¯æ•°æ®
                    const sessionData = {
                        id: validUser.id,
                        username: validUser.username,
                        email: validUser.email,
                        role: validUser.role,
                        avatar: validUser.avatar,
                        loginTime: new Date().toISOString(),
                        rememberMe: false
                    };

                    // ä¿å­˜åˆ°sessionStorage
                    sessionStorage.setItem('learnsync_current_user', JSON.stringify(sessionData));

                    html += '<p class="success">âœ… ä¼šè¯æ•°æ®å·²ä¿®å¤å¹¶ä¿å­˜</p>';
                    html += `<p class="info">ç”¨æˆ· ${validUser.username} ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ç³»ç»Ÿ</p>`;
                    html += '<button onclick="location.reload()">é‡æ–°åŠ è½½é¡µé¢æµ‹è¯•</button>';
                }

                statusDiv.innerHTML = html;
            } catch (error) {
                statusDiv.innerHTML = '<div class="alert alert-danger">âŒ å¼ºåˆ¶ä¿®å¤å¤±è´¥: ' + error.message + '</div>';
            }
        }
    </script>
</body>
</html>